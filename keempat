-- Training Points Multiplier GUI (Fixed Version)
-- Compatible with Delta Executor

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")

-- Konfigurasi
local MULTIPLIER = 694
local TARGET_POINTS = 1000000
local autoTrainEnabled = false
local scriptActive = false

-- Create GUI
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TopBar = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local MinimizeBtn = Instance.new("TextButton")
local ContentFrame = Instance.new("Frame")
local StatusLabel = Instance.new("TextLabel")
local MultiplierLabel = Instance.new("TextLabel")
local MultiplierInput = Instance.new("TextBox")
local SetMultiplierBtn = Instance.new("TextButton")
local StartBtn = Instance.new("TextButton")
local BoostBtn = Instance.new("TextButton")
local InfoLabel = Instance.new("TextLabel")
local MinimizedBtn = Instance.new("TextButton")

-- Properties
ScreenGui.Name = "TrainingMultiplierGUI"
ScreenGui.ResetOnSpawn = false

-- Coba parent ke CoreGui, jika gagal gunakan PlayerGui
local success = pcall(function()
    ScreenGui.Parent = game:GetService("CoreGui")
end)
if not success then
    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
end

-- Main Frame
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 320, 0, 300)
MainFrame.Position = UDim2.new(0.5, -160, 0.5, -150)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 8)
MainCorner.Parent = MainFrame

-- Top Bar
TopBar.Name = "TopBar"
TopBar.Size = UDim2.new(1, 0, 0, 35)
TopBar.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
TopBar.BorderSizePixel = 0
TopBar.Parent = MainFrame

local TopCorner = Instance.new("UICorner")
TopCorner.CornerRadius = UDim.new(0, 8)
TopCorner.Parent = TopBar

-- Title
Title.Name = "Title"
Title.Size = UDim2.new(1, -40, 1, 0)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "Training Multiplier"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 16
Title.Font = Enum.Font.GothamBold
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TopBar

-- Minimize Button
MinimizeBtn.Name = "MinimizeBtn"
MinimizeBtn.Size = UDim2.new(0, 30, 0, 30)
MinimizeBtn.Position = UDim2.new(1, -35, 0, 2.5)
MinimizeBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
MinimizeBtn.Text = "-"
MinimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeBtn.TextSize = 20
MinimizeBtn.Font = Enum.Font.GothamBold
MinimizeBtn.BorderSizePixel = 0
MinimizeBtn.Parent = TopBar

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 6)
MinCorner.Parent = MinimizeBtn

-- Content Frame
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, -20, 1, -45)
ContentFrame.Position = UDim2.new(0, 10, 0, 40)
ContentFrame.BackgroundTransparency = 1
ContentFrame.Parent = MainFrame

-- Status Label
StatusLabel.Name = "StatusLabel"
StatusLabel.Size = UDim2.new(1, 0, 0, 25)
StatusLabel.Position = UDim2.new(0, 0, 0, 5)
StatusLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
StatusLabel.Text = "Status: Ready"
StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
StatusLabel.TextSize = 14
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.BorderSizePixel = 0
StatusLabel.Parent = ContentFrame

local StatusCorner = Instance.new("UICorner")
StatusCorner.CornerRadius = UDim.new(0, 6)
StatusCorner.Parent = StatusLabel

-- Multiplier Label
MultiplierLabel.Name = "MultiplierLabel"
MultiplierLabel.Size = UDim2.new(1, 0, 0, 20)
MultiplierLabel.Position = UDim2.new(0, 0, 0, 38)
MultiplierLabel.BackgroundTransparency = 1
MultiplierLabel.Text = "Multiplier Value:"
MultiplierLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
MultiplierLabel.TextSize = 13
MultiplierLabel.Font = Enum.Font.Gotham
MultiplierLabel.TextXAlignment = Enum.TextXAlignment.Left
MultiplierLabel.Parent = ContentFrame

-- Multiplier Input
MultiplierInput.Name = "MultiplierInput"
MultiplierInput.Size = UDim2.new(0.6, 0, 0, 32)
MultiplierInput.Position = UDim2.new(0, 0, 0, 60)
MultiplierInput.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
MultiplierInput.Text = tostring(MULTIPLIER)
MultiplierInput.TextColor3 = Color3.fromRGB(255, 255, 255)
MultiplierInput.TextSize = 14
MultiplierInput.Font = Enum.Font.Gotham
MultiplierInput.PlaceholderText = "Enter multiplier"
MultiplierInput.BorderSizePixel = 0
MultiplierInput.ClearTextOnFocus = false
MultiplierInput.Parent = ContentFrame

local InputCorner = Instance.new("UICorner")
InputCorner.CornerRadius = UDim.new(0, 6)
InputCorner.Parent = MultiplierInput

-- Set Multiplier Button
SetMultiplierBtn.Name = "SetMultiplierBtn"
SetMultiplierBtn.Size = UDim2.new(0.35, 0, 0, 32)
SetMultiplierBtn.Position = UDim2.new(0.65, 0, 0, 60)
SetMultiplierBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
SetMultiplierBtn.Text = "SET"
SetMultiplierBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
SetMultiplierBtn.TextSize = 14
SetMultiplierBtn.Font = Enum.Font.GothamBold
SetMultiplierBtn.BorderSizePixel = 0
SetMultiplierBtn.Parent = ContentFrame

local SetBtnCorner = Instance.new("UICorner")
SetBtnCorner.CornerRadius = UDim.new(0, 6)
SetBtnCorner.Parent = SetMultiplierBtn

-- Start Script Button
StartBtn.Name = "StartBtn"
StartBtn.Size = UDim2.new(1, 0, 0, 38)
StartBtn.Position = UDim2.new(0, 0, 0, 102)
StartBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 100)
StartBtn.Text = "START SCRIPT"
StartBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
StartBtn.TextSize = 15
StartBtn.Font = Enum.Font.GothamBold
StartBtn.BorderSizePixel = 0
StartBtn.Parent = ContentFrame

local StartCorner = Instance.new("UICorner")
StartCorner.CornerRadius = UDim.new(0, 6)
StartCorner.Parent = StartBtn

-- Boost Button
BoostBtn.Name = "BoostBtn"
BoostBtn.Size = UDim2.new(1, 0, 0, 38)
BoostBtn.Position = UDim2.new(0, 0, 0, 150)
BoostBtn.BackgroundColor3 = Color3.fromRGB(255, 150, 50)
BoostBtn.Text = "Boost Training Now"
BoostBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
BoostBtn.TextSize = 15
BoostBtn.Font = Enum.Font.GothamBold
BoostBtn.BorderSizePixel = 0
BoostBtn.Parent = ContentFrame

local BoostCorner = Instance.new("UICorner")
BoostCorner.CornerRadius = UDim.new(0, 6)
BoostCorner.Parent = BoostBtn

-- Info Label
InfoLabel.Name = "InfoLabel"
InfoLabel.Size = UDim2.new(1, 0, 0, 50)
InfoLabel.Position = UDim2.new(0, 0, 0, 198)
InfoLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
InfoLabel.Text = "1. Set multiplier\n2. Click START SCRIPT\n3. Press E to train"
InfoLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
InfoLabel.TextSize = 11
InfoLabel.Font = Enum.Font.Gotham
InfoLabel.TextWrapped = true
InfoLabel.BorderSizePixel = 0
InfoLabel.Parent = ContentFrame

local InfoCorner = Instance.new("UICorner")
InfoCorner.CornerRadius = UDim.new(0, 6)
InfoCorner.Parent = InfoLabel

-- Minimized Button
MinimizedBtn.Name = "MinimizedBtn"
MinimizedBtn.Size = UDim2.new(0, 150, 0, 35)
MinimizedBtn.Position = UDim2.new(1, -160, 0, 10)
MinimizedBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
MinimizedBtn.Text = "Training Multiplier"
MinimizedBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizedBtn.TextSize = 13
MinimizedBtn.Font = Enum.Font.GothamBold
MinimizedBtn.BorderSizePixel = 0
MinimizedBtn.Visible = false
MinimizedBtn.Parent = ScreenGui

local MinimizedCorner = Instance.new("UICorner")
MinimizedCorner.CornerRadius = UDim.new(0, 6)
MinimizedCorner.Parent = MinimizedBtn

-- Functions
local function updateStatus(text, color)
    StatusLabel.Text = "Status: " .. text
    StatusLabel.TextColor3 = color
end

local function notif(text)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Training Multiplier",
        Text = text,
        Duration = 3
    })
end

-- Training Boost Function
local function boostTraining()
    if not scriptActive then
        notif("Please START SCRIPT first!")
        return
    end
    
    spawn(function()
        pcall(function()
            local TrainSpeedRemote = ReplicatedStorage:FindFirstChild("TrainSystem")
            if TrainSpeedRemote then
                TrainSpeedRemote = TrainSpeedRemote:FindFirstChild("Remote")
                if TrainSpeedRemote then
                    TrainSpeedRemote = TrainSpeedRemote:FindFirstChild("TrainSpeedHasChanged")
                    if TrainSpeedRemote then
                        -- Fire training speed dengan multiplier
                        for i = 1, MULTIPLIER do
                            TrainSpeedRemote:FireServer(4)
                            task.wait(0.01)
                        end
                        updateStatus("Training Boosted!", Color3.fromRGB(100, 255, 100))
                        notif("Training speed boosted x" .. MULTIPLIER)
                        task.wait(2)
                        updateStatus("Active", Color3.fromRGB(100, 255, 100))
                    end
                end
            end
        end)
    end)
end

-- Start Script Function
local function startScript()
    scriptActive = not scriptActive
    
    if scriptActive then
        StartBtn.Text = "STOP SCRIPT"
        StartBtn.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
        updateStatus("Active", Color3.fromRGB(100, 255, 100))
        notif("Script activated! Press E to train")
        
        -- Auto hook training when E is pressed
        local connection
        connection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
            if scriptActive and not gameProcessed and input.KeyCode == Enum.KeyCode.E then
                task.wait(0.1)
                boostTraining()
            end
        end)
        
        -- Store connection untuk cleanup
        getgenv().TrainingConnection = connection
        
    else
        StartBtn.Text = "START SCRIPT"
        StartBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 100)
        updateStatus("Stopped", Color3.fromRGB(255, 100, 100))
        notif("Script deactivated")
        
        -- Disconnect
        if getgenv().TrainingConnection then
            getgenv().TrainingConnection:Disconnect()
            getgenv().TrainingConnection = nil
        end
    end
end

-- Button Events
MinimizeBtn.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    MinimizedBtn.Visible = true
end)

MinimizedBtn.MouseButton1Click:Connect(function()
    MainFrame.Visible = true
    MinimizedBtn.Visible = false
end)

SetMultiplierBtn.MouseButton1Click:Connect(function()
    local value = tonumber(MultiplierInput.Text)
    if value and value > 0 and value <= 10000 then
        MULTIPLIER = math.floor(value)
        MultiplierInput.Text = tostring(MULTIPLIER)
        TARGET_POINTS = math.floor(1440 * MULTIPLIER)
        
        local displayPoints = TARGET_POINTS >= 1000000 
            and string.format("%.1fM", TARGET_POINTS/1000000) 
            or string.format("%.1fK", TARGET_POINTS/1000)
        
        InfoLabel.Text = string.format("Target: %s per train\nMultiplier: x%d\nPress E to train", displayPoints, MULTIPLIER)
        updateStatus("Multiplier Set!", Color3.fromRGB(100, 255, 100))
        notif("Multiplier set to x" .. MULTIPLIER)
        task.wait(1.5)
        if scriptActive then
            updateStatus("Active", Color3.fromRGB(100, 255, 100))
        else
            updateStatus("Ready", Color3.fromRGB(255, 200, 100))
        end
    else
        updateStatus("Invalid Value!", Color3.fromRGB(255, 100, 100))
        notif("Enter value 1-10000")
        task.wait(1.5)
        updateStatus("Ready", Color3.fromRGB(255, 200, 100))
    end
end)

StartBtn.MouseButton1Click:Connect(startScript)

BoostBtn.MouseButton1Click:Connect(boostTraining)

-- Startup
task.wait(0.5)
updateStatus("Ready", Color3.fromRGB(255, 200, 100))
notif("Training Multiplier loaded!")

print("=================================")
print("Training Multiplier GUI Loaded!")
print("Version: 2.0 (Fixed)")
print("Default Multiplier: " .. MULTIPLIER)
print("=================================")
